/*
 * @name: vuescroll 2.7.7
 * @author: wangyi
 * @description: A virtual scrollbar based on vue.js 2.x inspired by slimscroll
 * @license: MIT
 * @GitHub: https://github.com/wangyi7099/vuescroll
 */
!function(e,t){"function"==typeof define&&define.amd?define(t):"undefined"!=typeof module?module.exports=t():e.Vue.use(t())}(this,function(){function e(e,t){return window.getComputedStyle(e).getPropertyValue(t)}var t={install:function(e){e.component(r.name,r),e.component(a.name,a),e.component(l.name,l),e.component(o.name,o)}},l={name:"vueScrollPanel",render:function(e){var t=this,l=t.scrollContentStyle;return l.overflow="hidden",e("div",{style:l,class:"vueScrollPanel",on:{mouseenter:function(){t.$emit("showBar")},mouseleave:function(){t.$emit("hideBar")},mousemove:function(){t.$emit("showBar")}}},this.$slots.default)},props:{id:{require:!0},scrollContentStyle:{}}},r={name:"vScrollBar",render:function(e){var t=this,l={height:t.state.height+"px",width:t.ops.width,position:"absolute",background:t.ops.background,top:t.state.top+"px",transition:"opacity .5s",cursor:"pointer",opacity:t.state.opacity,userSelect:"none"};return"right"==t.ops.pos?l.right=0:l.left=0,e("div",{style:l,class:"vScrollBar",on:{mouseenter:function(e){t.$emit("showVBar")}}},this.$slots.default)},props:{ops:{require:!1,default:{background:"hsla(220,4%,58%,.3)",width:"5px",float:"left",opacity:0,pos:"left"}},state:{top:{default:0},height:{default:0},opacity:{default:0}}}},a={name:"hScrollBar",render:function(e){var t=this,l={height:t.ops.height,width:t.state.width+"px",position:"absolute",background:t.ops.background,left:t.state.left+"px",transition:"opacity .5s",cursor:"pointer",opacity:t.state.opacity,userSelect:"none"};return"bottom"==t.ops.pos?l.bottom=0:l.top=0,e("div",{style:l,class:"hScrollBar",on:{mouseenter:function(e){t.$emit("showHBar")}}},this.$slots.default)},props:{ops:{require:!1,default:{background:"hsla(220,4%,58%,.3)",height:"5px",opacity:0,pos:"bottom"}},state:{left:{default:0},width:{default:0},opacity:{default:0}}}},o={name:"vueScroll",class:"vueScroll",data:()=>({scrollPanel:{el:"",ops:{}},vScrollBar:{el:"",ops:{background:"hsla(220,4%,58%,.3)",width:"5px",pos:"",deltaY:30,keepShow:!1,opacity:1},state:{top:0,height:0,opacity:0},minBarHeight:35,innerDeltaY:0},hScrollBar:{el:"",ops:{background:"hsla(220,4%,58%,.3)",height:"5px",deltaX:30,pos:"",keepShow:!1,opacity:1},state:{left:0,width:0,opacity:0},minBarWidth:35,innerDeltaX:0},listeners:[],mousedown:!1,isMouseLeavePanel:!0}),render:function(e){var t=this;return e("div",{style:{position:"relative",height:"100%",width:"100%"},on:{wheel:t.wheel,mouseenter:function(){t.isMouseLeavePanel=!1,t.showBar()},mouseleave:function(){t.isMouseLeavePanel=!0,t.hideBar()}}},[e("vueScrollPanel",{ref:"vueScrollPanel",on:{showBar:t.showBar,hideBar:t.hideBar},props:{scrollContentStyle:t.scrollContentStyle}},t.$slots.default),e("vScrollBar",{props:{ops:t.vScrollBar.ops,state:t.vScrollBar.state},ref:"vScrollBar",on:{showVBar:t.showVBar,hideVBar:t.hideVBar}}),e("hScrollBar",{props:{ops:t.hScrollBar.ops,state:t.hScrollBar.state},ref:"hScrollBar",on:{showHBar:t.showHBar,hideHBar:t.hideHBar}})])},mounted(){this.initEl(),this.mergeAll(),this.listenVBarDrag(),this.listenHBarDrag(),this.listenPanelTouch(),this.listenPanelDrag(),this.showBar()},methods:{initEl(){this.scrollPanel.el=this.$refs.vueScrollPanel&&this.$refs.vueScrollPanel.$el,this.vScrollBar.el=this.$refs.vScrollBar&&this.$refs.vScrollBar.$el,this.hScrollBar.el=this.$refs.hScrollBar&&this.$refs.hScrollBar.$el},mergeAll(){this.merge(this.ops.vBar,this.vScrollBar.ops),this.merge(this.ops.hBar,this.hScrollBar.ops)},merge(e,t,l){for(key in e)!1===l?this.$set(t,key,e[key]):Object.hasOwnProperty.call(t,key)&&this.$set(t,key,e[key])},scrollTo(e){let t=e.x||this.scrollPanel.el.scrollLeft,l=e.y||this.scrollPanel.el.scrollTop;this.scrollPanel.el.scrollLeft=t,this.scrollPanel.el.scrollTop=l},getVBarHeight({deltaY:t}){var l=Math.floor(e(this.scrollPanel.el,"height").replace("px","")),r=Math.floor(this.scrollPanel.el.scrollHeight),a=Math.ceil((r-l)/Math.abs(t)),o=Math.max(l/(r/l),this.vScrollBar.minBarHeight);return r<=l||Math.abs(l-r)<=this.accuracy?o=0:(this.vScrollBar.innerDeltaY=(l-o)/a,{height:o,scrollPanelHeight:l,scrollPanelScrollHeight:r,deltaY:t})},getHBarWidth({deltaX:t}){var l=Math.floor(e(this.scrollPanel.el,"width").replace("px","")),r=Math.floor(this.scrollPanel.el.scrollWidth),a=Math.ceil((r-l)/Math.abs(t)),o=Math.max(l/(r/l),this.hScrollBar.minBarWidth);return r<=l||Math.abs(l-r)<=this.accuracy?o=0:(this.hScrollBar.innerDeltaX=(l-o)/a,{width:o,scrollPanelWidth:l,scrollPanelScrollWidth:r,deltaX:t})},resizeVBarTop({height:e,scrollPanelHeight:t,scrollPanelScrollHeight:l,deltaY:r}){var a=l-t-this.scrollPanel.el.scrollTop;return a<this.accuracy&&(a=0),t-(e+Math.abs(Math.ceil(a/r))*this.vScrollBar.innerDeltaY)},resizeHBarLeft({width:e,scrollPanelWidth:t,scrollPanelScrollWidth:l,deltaX:r}){var a=l-t-this.scrollPanel.el.scrollLeft;return a<this.accuracy&&(a=0),t-(e+Math.abs(Math.ceil(a/r))*this.hScrollBar.innerDeltaX)},showBar(){this.showVBar(),this.showHBar()},hideBar(){this.hideVBar(),this.hideHBar()},showVBar(){var e,t={deltaY:this.vScrollBar.ops.deltaY};this.isMouseLeavePanel&&!this.vScrollBar.ops.keepShow||(this.vScrollBar.state.height=e=this.getVBarHeight(t))&&(this.vScrollBar.state.top=this.resizeVBarTop(e),this.vScrollBar.state.height=e.height,this.vScrollBar.state.opacity=this.vScrollBar.ops.opacity)},showHBar(){var e,t={deltaX:this.hScrollBar.ops.deltaX};this.isMouseLeavePanel&&!this.hScrollBar.ops.keepShow||(this.hScrollBar.state.width=e=this.getHBarWidth(t))&&(this.hScrollBar.state.left=this.resizeHBarLeft(e),this.hScrollBar.state.width=e.width,this.hScrollBar.state.opacity=this.hScrollBar.ops.opacity)},hideVBar(){this.vScrollBar.ops.keepShow||!this.mousedown&&this.isMouseLeavePanel&&(this.vScrollBar.state.opacity=0)},hideHBar(){this.hScrollBar.ops.keepShow||!this.mousedown&&this.isMouseLeavePanel&&(this.hScrollBar.state.opacity=0)},wheel(e){this.showVBar(),this.scrollVBar(e.deltaY>0?1:-1,1),e.stopPropagation()},scrollVBar:function(t,l){var r=this.vScrollBar.state.top,a=e(this.scrollPanel.el,"height").replace("px",""),o=this.scrollPanel.el.scrollHeight,s=this.scrollPanel.el.scrollTop,i=this.vScrollBar.state.height,h=this.vScrollBar.innerDeltaY,n=this.vScrollBar.ops.deltaY;if(!(t<0&&r<=0||a<=r+i&&t>0||Math.abs(o-a)<this.accuracy)){var c=r+t*h*l,d=s+t*n*l;t<0?(this.vScrollBar.state.top=Math.max(0,c),this.scrollPanel.el.scrollTop=Math.max(0,d)):t>0&&(this.vScrollBar.state.top=Math.min(a-i,c),this.scrollPanel.el.scrollTop=Math.min(o-a,d))}var u,p={},B={};p.residual=o-s-a,p.scrolled=s,B.scrolled=this.vScrollBar.state.top,B.residual=a-this.vScrollBar.state.top-this.vScrollBar.state.height,B.height=this.vScrollBar.state.height,u=B.scrolled/(a-B.height),B.name="vBar",p.name="content",this.$emit("vscroll",B,p,u)},scrollHBar:function(t,l){var r=this.hScrollBar.state.left,a=e(this.scrollPanel.el,"width").replace("px",""),o=this.scrollPanel.el.scrollWidth,s=this.scrollPanel.el.scrollLeft,i=this.hScrollBar.state.width,h=this.hScrollBar.innerDeltaX,n=this.hScrollBar.ops.deltaX;if(!(t<0&&r<=0||a<=r+i&&t>0||Math.abs(o-a)<this.accuracy)){var c=r+t*h*l,d=s+t*n*l;t<0?(this.hScrollBar.state.left=Math.max(0,c),this.scrollPanel.el.scrollLeft=Math.max(0,d)):t>0&&(this.hScrollBar.state.left=Math.min(a-i,c),this.scrollPanel.el.scrollLeft=Math.min(o-a,d))}var u,p={},B={};p.residual=o-s-a,p.scrolled=s,B.scrolled=this.hScrollBar.state.left,B.residual=a-this.hScrollBar.state.left-this.hScrollBar.state.width,B.width=this.hScrollBar.state.width,u=B.scrolled/(a-B.width),B.name="hBar",p.name="content",this.$emit("hscroll",B,p,u)},listenVBarDrag:function(){var e,t,l=this,r=!1;function a(a){var o=(t=a.pageY)-e;if(!o)return!1;r=!0,l.scrollVBar(o>0?1:-1,Math.abs(o/l.vScrollBar.innerDeltaY)),e=t}function o(e){l.mousedown=!1,l.hideVBar(),document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",o),r&&l.$emit("endScroll",{x:l.scrollPanel.el.scrollLeft,y:l.scrollPanel.el.scrollTop}),r=!1}function s(t){var r={deltaY:l.vScrollBar.ops.deltaY};l.getVBarHeight(r)&&(l.mousedown=!0,e=t.pageY,l.showVBar(),document.addEventListener("mousemove",a),document.addEventListener("mouseup",o))}this.listeners.push({dom:l.vScrollBar.el,event:s,type:"mousedown"}),l.vScrollBar.el.addEventListener("mousedown",s)},listenHBarDrag:function(){var e,t,l=this,r=!1;function a(a){var o=(t=a.pageX)-e;if(!o)return!1;r=!0,l.scrollHBar(o>0?1:-1,Math.abs(o/l.hScrollBar.innerDeltaX)),e=t}function o(e){l.mousedown=!1,l.hideHBar(),document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",o),r&&l.$emit("endScroll",{x:l.scrollPanel.el.scrollLeft,y:l.scrollPanel.el.scrollTop}),r=!1}function s(t){var r={deltaX:l.hScrollBar.ops.deltaX};l.getHBarWidth(r)&&(l.mousedown=!0,e=t.pageX,l.showHBar(),document.addEventListener("mousemove",a),document.addEventListener("mouseup",o))}this.listeners.push({dom:l.hScrollBar.el,event:s,type:"mousedown"}),l.hScrollBar.el.addEventListener("mousedown",s)},listenPanelTouch:function(){var e,t,l,r,a=this,o=this.scrollPanel.el;function s(o){if(o.touches.length){var s=o.touches[0];l=s.pageX,r=s.pageY;var i=void 0,h=l-e,n=r-t;Math.abs(h)>Math.abs(n)?(i=h,a.scrollHBar(i>0?-1:1,Math.abs(i/a.hScrollBar.innerDeltaX))):Math.abs(h)<Math.abs(n)&&(i=n,a.scrollVBar(i>0?-1:1,Math.abs(i/a.vScrollBar.innerDeltaY))),e=l,t=r}}function i(l){var r={deltaY:a.vScrollBar.ops.deltaY},i={deltaX:a.hScrollBar.ops.deltaX};if((a.getHBarWidth(i)||a.getVBarHeight(r))&&l.touches.length){l.stopPropagation();var h=l.touches[0];a.mousedown=!0,e=h.pageX,t=h.pageY,a.showBar(),o.addEventListener("touchmove",s),o.addEventListener("touchend",function(e){a.mousedown=!1,a.hideBar(),o.removeEventListener("touchmove",s)})}}o.addEventListener("touchstart",i),this.listeners.push({dom:o,event:i,type:"touchstart"})},listenPanelDrag:function(){var e,t,l,r,a=this,o=this.scrollPanel.el,s=!1;function i(o){l=o.pageX,r=o.pageY;var i=void 0,h=l-e,n=r-t;if(!h&&!n)return!1;s=!0,Math.abs(h)>Math.abs(n)?(i=h,a.scrollHBar(i>0?-1:1,Math.abs(i/a.hScrollBar.innerDeltaX)/3)):Math.abs(h)<Math.abs(n)&&(i=n,a.scrollVBar(i>0?-1:1,Math.abs(i/a.vScrollBar.innerDeltaY)/3)),e=l,t=r}function h(e){a.mousedown=!1,a.hideHBar(),a.hideVBar(),document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",h),s&&a.$emit("endScroll",{x:a.scrollPanel.el.scrollLeft,y:a.scrollPanel.el.scrollTop}),s=!1}function n(l){var r={deltaX:a.hScrollBar.ops.deltaX},o={deltaY:a.vScrollBar.ops.deltaY};a.getHBarWidth(r)&&a.getVBarHeight(o)&&(a.mousedown=!0,e=l.pageX,a.showHBar(),t=l.pageY,a.showVBar(),document.addEventListener("mousemove",i),document.addEventListener("mouseup",h))}o.addEventListener("mousedown",n),this.listeners.push({dom:o,event:n,type:"mousedown"})}},beforeDestroy(){this.listeners.forEach(function(e){e.dom.removeEventListener(e.type,e.event)})},props:{ops:{default:function(){return{vBar:{},hBar:{}}}},scrollContentStyle:{default:function(){return{width:"100%",height:"100%"}}},accuracy:{default:5}}};return t});